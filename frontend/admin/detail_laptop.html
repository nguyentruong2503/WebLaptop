<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chi tiết Laptop - Admin</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Poppins", sans-serif;
        background-color: #f8fafc;
      }
      .card-shadow {
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1),
          0 2px 4px -1px rgba(0, 0, 0, 0.06);
      }
    </style>
  </head>
  <body class="min-h-screen flex">
    <div class="flex-1 ml-64">
      <header
        class="bg-white card-shadow py-4 px-8 flex justify-between items-center"
      >
        <div>
          <h2 class="text-2xl font-bold text-gray-800">Chi tiết Laptop</h2>
          <p class="text-gray-600">Thông số kỹ thuật</p>
        </div>
      </header>

      <div class="p-8">
        <div class="bg-white rounded-xl card-shadow p-6 mb-8">
          <div class="flex justify-between items-center mb-6">
            <h3 class="text-xl font-bold text-gray-800">Thông số sản phẩm</h3>
          </div>

          <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Hình ảnh -->
            <div class="lg:col-span-1">
              <div
                class="bg-gray-100 rounded-xl p-4 flex items-center justify-center h-64"
              >
                <img
                  id="productImg"
                  src="https://via.placeholder.com/250"
                  alt="Laptop"
                  class="max-h-full object-contain"
                />
              </div>
            </div>

            <!-- Thông số cơ bản -->
            <div class="lg:col-span-2">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                  <h4 class="text-sm font-medium text-gray-500">ID</h4>
                  <p class="font-medium" id="productID"></p>
                </div>
                <div>
                  <h4 class="text-sm font-medium text-gray-500">
                    Tên sản phẩm
                  </h4>
                  <p class="font-medium" id="productName"></p>
                </div>
                <div>
                  <h4 class="text-sm font-medium text-gray-500">Màn hình</h4>
                  <p class="font-medium" id="screenSpecs"></p>
                </div>
                <div>
                  <h4 class="text-sm font-medium text-gray-500">CPU</h4>
                  <p class="font-medium" id="CPU"></p>
                </div>
                <div>
                  <h4 class="text-sm font-medium text-gray-500">RAM</h4>
                  <p class="font-medium" id="RAM"></p>
                </div>
                <div>
                  <h4 class="text-sm font-medium text-gray-500">SSD</h4>
                  <p class="font-medium" id="SSD"></p>
                </div>
                <div>
                  <h4 class="text-sm font-medium text-gray-500">GPU</h4>
                  <p class="font-medium" id="GPU"></p>
                </div>
                <div>
                  <h4 class="text-sm font-medium text-gray-500">Loại GPU</h4>
                  <p class="font-medium" id="GPU_type"></p>
                </div>
                <div>
                  <h4 class="text-sm font-medium text-gray-500">
                    Dung lượng pin (Wh)
                  </h4>
                  <p class="font-medium" id="battery_capacity"></p>
                </div>
                <div>
                  <h4 class="text-sm font-medium text-gray-500">
                    Công suất sạc (W)
                  </h4>
                  <p class="font-medium" id="charging_watt"></p>
                </div>
                <div>
                  <h4 class="text-sm font-medium text-gray-500">
                    Trọng lượng (kg)
                  </h4>
                  <p class="font-medium" id="weight"></p>
                </div>
                <div>
                  <h4 class="text-sm font-medium text-gray-500">Kích thước</h4>
                  <p class="font-medium" id="dimensions"></p>
                </div>
              </div>
            </div>
          </div>

          <!-- Thông số bổ sung -->
          <div class="mt-8">
            <h3 class="text-lg font-bold text-gray-800 mb-4">
              Thông số bổ sung
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
              <div>
                <h4 class="text-sm font-medium text-gray-500">Khe mở rộng</h4>
                <p class="font-medium" id="expandable_slots"></p>
              </div>
              <div>
                <h4 class="text-sm font-medium text-gray-500">Cổng USB-A</h4>
                <p class="font-medium" id="USB_A_ports"></p>
              </div>
              <div>
                <h4 class="text-sm font-medium text-gray-500">Cổng USB-C</h4>
                <p class="font-medium" id="USB_C_ports"></p>
              </div>
              <div>
                <h4 class="text-sm font-medium text-gray-500">Cổng HDMI</h4>
                <p class="font-medium" id="HDMI_ports"></p>
              </div>
              <div>
                <h4 class="text-sm font-medium text-gray-500">Cổng LAN</h4>
                <p class="font-medium" id="LAN_port"></p>
              </div>
              <div>
                <h4 class="text-sm font-medium text-gray-500">
                  Cổng Thunderbolt
                </h4>
                <p class="font-medium" id="Thunderbolt_ports"></p>
              </div>
              <div>
                <h4 class="text-sm font-medium text-gray-500">Jack 3.5mm</h4>
                <p class="font-medium" id="jack_3_5mm"></p>
              </div>
              <div class="md:col-span-2 lg:col-span-3">
                <h4 class="text-sm font-medium text-gray-500">
                  Tính năng đặc biệt
                </h4>
                <p class="font-medium" id="special_features"></p>
              </div>
            </div>
          </div>

          <!-- Mô tả -->
          <div class="mt-8">
            <h3 class="text-lg font-bold text-gray-800 mb-4">Mô tả</h3>
            <p class="text-gray-700" id="description"></p>
          </div>

          <!-- Ngày tạo/cập nhật -->
          <div class="mt-8 pt-6 border-t border-gray-200">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <h4 class="text-sm font-medium text-gray-500">Ngày tạo</h4>
                <p class="font-medium" id="created_at"></p>
              </div>
              <div>
                <h4 class="text-sm font-medium text-gray-500">Ngày cập nhật</h4>
                <p class="font-medium" id="updated_at"></p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script type="module">
      import { fetchWithTokenRetry } from "http://127.0.0.1:5501/frontend/js/authFetch.js";

      // Lấy id laptop từ URL
      const params = new URLSearchParams(window.location.search);
      const productId = params.get("id");

      if (!productId) {
        alert("Không có ID sản phẩm!");
      } else {
        fetchWithTokenRetry(`http://127.0.0.1:8000/api/laptop/${productId}`)
          .then(async (res) => {
            if (!res.ok) {
              const errText = await res.text();
              throw new Error(`Lỗi khi tải laptop: ${res.status} - ${errText}`);
            }
            return res.json();
          })
          .then((resJson) => {
            const laptop = resJson.data; // lấy đúng data
            // Hình ảnh
            document.getElementById("productImg").src =
              laptop.img || "https://via.placeholder.com/250";

            const fields = {
              productID: laptop.productID,
              productName: laptop.productName,
              screenSpecs: laptop.screenSpecs,
              CPU: laptop.CPU,
              RAM: laptop.RAM,
              SSD: laptop.SSD,
              GPU: laptop.GPU,
              GPU_type: laptop.GPU_type,
              battery_capacity: laptop.battery_capacity_wh,
              charging_watt: laptop.charging_watt,
              weight: laptop.weight_kg,
              dimensions: laptop.dimensions,
              expandable_slots: laptop.expandable_slots,
              USB_A_ports: laptop.USB_A_ports,
              USB_C_ports: laptop.USB_C_ports,
              HDMI_ports: laptop.HDMI_ports,
              LAN_port: laptop.LAN_port,
              Thunderbolt_ports: laptop.Thunderbolt_ports,
              jack_3_5mm: laptop.jack_3_5mm,
              special_features: laptop.special_features,
              description: laptop.des,
              created_at: laptop.created_at,
              updated_at: laptop.updated_at,
            };

            for (const id in fields) {
              const el = document.getElementById(id);
              if (el) el.textContent = fields[id] ?? "N/A";
            }
          })

          .catch((err) => {
            console.error(err);
            alert("Lỗi khi tải dữ liệu laptop: " + err.message);
          });
      }
    </script>
  </body>
</html>
